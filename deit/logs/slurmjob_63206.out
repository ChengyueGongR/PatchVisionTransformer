Fri Jan  1 12:59:21 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 410.129      Driver Version: 410.129      CUDA Version: 10.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla V100-SXM2...  On   | 00000000:06:00.0 Off |                    0 |
| N/A   35C    P0    45W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla V100-SXM2...  On   | 00000000:07:00.0 Off |                    0 |
| N/A   38C    P0    45W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla V100-SXM2...  On   | 00000000:0A:00.0 Off |                    0 |
| N/A   37C    P0    44W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   3  Tesla V100-SXM2...  On   | 00000000:0B:00.0 Off |                    0 |
| N/A   35C    P0    44W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   4  Tesla V100-SXM2...  On   | 00000000:85:00.0 Off |                    0 |
| N/A   35C    P0    42W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   5  Tesla V100-SXM2...  On   | 00000000:86:00.0 Off |                    0 |
| N/A   36C    P0    44W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   6  Tesla V100-SXM2...  On   | 00000000:89:00.0 Off |                    0 |
| N/A   37C    P0    46W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   7  Tesla V100-SXM2...  On   | 00000000:8A:00.0 Off |                    0 |
| N/A   35C    P0    44W / 300W |      0MiB / 32480MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
top - 12:59:21 up 15 days,  1:33,  0 users,  load average: 1.35, 7.75, 9.87
Tasks: 845 total,   1 running, 420 sleeping,   0 stopped,   0 zombie
%Cpu(s): 26.5 us,  6.6 sy,  0.0 ni, 65.7 id,  1.2 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem : 52826400+total, 36459427+free,  3964688 used, 15970504+buff/cache
KiB Swap:        0 total,        0 free,        0 used. 52087737+avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
59298 cygong    20   0   39720   4272   2956 R   5.6  0.0   0:00.03 top -bn 1 +
Processing /u/cygong/Desktop/timm_conv
Requirement already satisfied: torch>=1.0 in /u/cygong/anaconda/envs/dgx/lib/python3.8/site-packages (from timm==0.3.2) (1.7.1)
Requirement already satisfied: torchvision in /u/cygong/anaconda/envs/dgx/lib/python3.8/site-packages (from timm==0.3.2) (0.8.2)
Requirement already satisfied: typing_extensions in /u/cygong/anaconda/envs/dgx/lib/python3.8/site-packages (from torch>=1.0->timm==0.3.2) (3.7.4.3)
Requirement already satisfied: numpy in /u/cygong/anaconda/envs/dgx/lib/python3.8/site-packages (from torch>=1.0->timm==0.3.2) (1.19.2)
Requirement already satisfied: pillow>=4.1.1 in /u/cygong/anaconda/envs/dgx/lib/python3.8/site-packages (from torchvision->timm==0.3.2) (8.0.1)
Building wheels for collected packages: timm
  Building wheel for timm (setup.py): started
  Building wheel for timm (setup.py): finished with status 'done'
  Created wheel for timm: filename=timm-0.3.2-py3-none-any.whl size=240667 sha256=17e076e449d3c60e7391cd9a255af475084cc40d6d83c0002adbd12e5592cdcd
  Stored in directory: /tmp/pip-ephem-wheel-cache-xa6ofu36/wheels/16/91/7b/72bc2a85e27c5a651ecc9d3fb6639ae0d7b538473fe4206117
Successfully built timm
Installing collected packages: timm
  Attempting uninstall: timm
    Found existing installation: timm 0.3.2
    Uninstalling timm-0.3.2:
      Successfully uninstalled timm-0.3.2
Successfully installed timm-0.3.2
| distributed init (rank 1): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
| distributed init (rank 0): env://
Namespace(aa='rand-m9-mstd0.5-inc1', batch_size=512, clip_grad=None, color_jitter=0.4, cooldown_epochs=10, cutmix=1.0, cutmix_minmax=None, data_path='/scratch/cluster/dilin/datasets/imagenet', data_set='IMNET', decay_epochs=30, decay_rate=0.1, device='cuda', dist_backend='nccl', dist_url='env://', distributed=True, drop=0.0, drop_block=None, drop_path=0.1, epochs=300, eval=False, gpu=0, inat_category='name', input_size=224, lr=0.0005, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, min_lr=1e-05, mixup=0.8, mixup_mode='batch', mixup_prob=1.0, mixup_switch_prob=0.5, model='deit_tiny_patch16_224', model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, momentum=0.9, num_workers=10, opt='adamw', opt_betas=None, opt_eps=1e-08, output_dir='/scratch/cluster/cygong/vision_transformer_unshare_multimlp_post', patience_epochs=10, pin_mem=True, rank=0, recount=1, remode='pixel', repeated_aug=True, reprob=0.25, resplit=False, resume='/scratch/cluster/cygong/vision_transformer_unshare_multimlp_post/checkpoint.pth', sched='cosine', seed=0, smoothing=0.1, start_epoch=0, train_interpolation='bicubic', warmup_epochs=5, warmup_lr=1e-06, weight_decay=0.05, world_size=4)
Creating model: deit_tiny_patch16_224
number of params: 5537128
4
Start training
Epoch: [32]  [  0/625]  eta: 2:20:58  lr: 0.001948  loss: 5.6679 (5.6679)  time: 13.5338  data: 9.6871  max mem: 19711
Epoch: [32]  [100/625]  eta: 0:10:03  lr: 0.001948  loss: 5.1057 (4.9145)  time: 1.0187  data: 0.0003  max mem: 19731
Epoch: [32]  [200/625]  eta: 0:07:36  lr: 0.001948  loss: 4.5452 (4.8417)  time: 1.0004  data: 0.0003  max mem: 19731
Epoch: [32]  [300/625]  eta: 0:05:41  lr: 0.001948  loss: 4.4163 (4.7804)  time: 1.0037  data: 0.0003  max mem: 19731
Epoch: [32]  [400/625]  eta: 0:03:53  lr: 0.001948  loss: 4.9154 (4.7924)  time: 1.0105  data: 0.0003  max mem: 19731
Epoch: [32]  [500/625]  eta: 0:02:09  lr: 0.001948  loss: 4.8182 (4.7924)  time: 1.0081  data: 0.0003  max mem: 19731
Epoch: [32]  [600/625]  eta: 0:00:25  lr: 0.001948  loss: 4.9774 (4.8065)  time: 1.0100  data: 0.0003  max mem: 19731
Epoch: [32]  [624/625]  eta: 0:00:01  lr: 0.001948  loss: 5.1349 (4.8118)  time: 0.9730  data: 0.0005  max mem: 19731
Epoch: [32] Total time: 0:10:42 (1.0279 s / it)
Averaged stats: lr: 0.001948  loss: 5.1349 (4.7956)
Test:  [ 0/98]  eta: 0:12:36  loss: 1.5448 (1.5448)  acc1: 63.6719 (63.6719)  acc5: 89.6484 (89.6484)  time: 7.7173  data: 7.4550  max mem: 19731
Test:  [10/98]  eta: 0:01:49  loss: 1.6613 (1.7261)  acc1: 63.4766 (62.5888)  acc5: 87.6953 (84.8722)  time: 1.2471  data: 0.9876  max mem: 19731
Test:  [20/98]  eta: 0:01:14  loss: 1.7078 (1.7890)  acc1: 59.1797 (59.7098)  acc5: 85.7422 (84.2448)  time: 0.6157  data: 0.3624  max mem: 19731
Test:  [30/98]  eta: 0:00:58  loss: 1.6767 (1.7682)  acc1: 58.5938 (59.6585)  acc5: 86.3281 (85.2256)  time: 0.6383  data: 0.3892  max mem: 19731
Test:  [40/98]  eta: 0:00:45  loss: 1.6767 (1.7721)  acc1: 59.1797 (59.9324)  acc5: 86.9141 (85.2087)  time: 0.6181  data: 0.3665  max mem: 19731
Test:  [50/98]  eta: 0:00:36  loss: 2.2010 (1.9374)  acc1: 51.3672 (56.8589)  acc5: 74.8047 (82.4334)  time: 0.5900  data: 0.3375  max mem: 19731
Test:  [60/98]  eta: 0:00:27  loss: 2.5749 (2.0219)  acc1: 43.9453 (55.6416)  acc5: 70.8984 (80.8594)  time: 0.5618  data: 0.3088  max mem: 19731
Test:  [70/98]  eta: 0:00:19  loss: 2.5032 (2.0903)  acc1: 46.8750 (54.3711)  acc5: 71.6797 (79.6737)  time: 0.5693  data: 0.3160  max mem: 19731
Test:  [80/98]  eta: 0:00:12  loss: 2.5632 (2.1652)  acc1: 45.7031 (53.1250)  acc5: 71.0938 (78.4192)  time: 0.5798  data: 0.3252  max mem: 19731
Test:  [90/98]  eta: 0:00:05  loss: 2.6850 (2.2092)  acc1: 44.3359 (52.2193)  acc5: 70.1172 (77.7451)  time: 0.5579  data: 0.3051  max mem: 19731
Test:  [97/98]  eta: 0:00:00  loss: 2.3157 (2.1813)  acc1: 48.8281 (52.8100)  acc5: 73.8281 (78.1780)  time: 0.5734  data: 0.2816  max mem: 19731
Test: Total time: 0:01:03 (0.6490 s / it)
* Acc@1 52.810 Acc@5 78.178 loss 2.181
Accuracy of the network on the 50000 test images: 52.8%
Max accuracy: 52.81%
Epoch: [33]  [  0/625]  eta: 4:28:29  lr: 0.001945  loss: 4.1650 (4.1650)  time: 25.7751  data: 10.3833  max mem: 19731
Epoch: [33]  [100/625]  eta: 0:10:58  lr: 0.001945  loss: 4.6887 (4.6965)  time: 1.0047  data: 0.0003  max mem: 19731
Epoch: [33]  [200/625]  eta: 0:07:59  lr: 0.001945  loss: 4.2924 (4.7384)  time: 1.0130  data: 0.0003  max mem: 19731
Epoch: [33]  [300/625]  eta: 0:05:55  lr: 0.001945  loss: 5.1114 (4.7494)  time: 1.0139  data: 0.0003  max mem: 19731
Epoch: [33]  [400/625]  eta: 0:04:01  lr: 0.001945  loss: 4.8687 (4.7494)  time: 1.0100  data: 0.0003  max mem: 19731
Epoch: [33]  [500/625]  eta: 0:02:12  lr: 0.001945  loss: 5.1464 (4.7635)  time: 1.0157  data: 0.0003  max mem: 19731
Epoch: [33]  [600/625]  eta: 0:00:26  lr: 0.001945  loss: 4.8383 (4.7791)  time: 1.0027  data: 0.0003  max mem: 19731
Epoch: [33]  [624/625]  eta: 0:00:01  lr: 0.001945  loss: 4.7096 (4.7732)  time: 0.9768  data: 0.0006  max mem: 19731
Epoch: [33] Total time: 0:10:56 (1.0501 s / it)
Averaged stats: lr: 0.001945  loss: 4.7096 (4.7765)
Test:  [ 0/98]  eta: 0:12:50  loss: 1.4027 (1.4027)  acc1: 70.3125 (70.3125)  acc5: 90.6250 (90.6250)  time: 7.8611  data: 7.5537  max mem: 19731
Test:  [10/98]  eta: 0:01:46  loss: 1.6096 (1.7043)  acc1: 66.2109 (63.2635)  acc5: 87.1094 (84.7479)  time: 1.2087  data: 0.9584  max mem: 19731
Test:  [20/98]  eta: 0:01:12  loss: 1.8438 (1.7585)  acc1: 58.2031 (60.5748)  acc5: 84.7656 (84.8865)  time: 0.5803  data: 0.3330  max mem: 19731
Test:  [30/98]  eta: 0:00:56  loss: 1.8155 (1.7431)  acc1: 58.2031 (60.1373)  acc5: 86.1328 (85.5973)  time: 0.6121  data: 0.3583  max mem: 19731
Test:  [40/98]  eta: 0:00:44  loss: 1.6372 (1.7381)  acc1: 60.7422 (60.7755)  acc5: 86.9141 (85.5659)  time: 0.6113  data: 0.3581  max mem: 19731
Test:  [50/98]  eta: 0:00:36  loss: 2.3084 (1.8992)  acc1: 51.5625 (57.6861)  acc5: 75.5859 (82.8891)  time: 0.6498  data: 0.3984  max mem: 19731
Test:  [60/98]  eta: 0:00:29  loss: 2.4529 (1.9841)  acc1: 46.0938 (56.4069)  acc5: 73.0469 (81.2884)  time: 0.7928  data: 0.5350  max mem: 19731
Test:  [70/98]  eta: 0:00:22  loss: 2.4280 (2.0531)  acc1: 47.4609 (55.0919)  acc5: 73.2422 (80.1689)  time: 0.8783  data: 0.6223  max mem: 19731
Test:  [80/98]  eta: 0:00:14  loss: 2.5243 (2.1270)  acc1: 46.4844 (53.8580)  acc5: 71.0938 (78.8845)  time: 0.8798  data: 0.6302  max mem: 19731
Test:  [90/98]  eta: 0:00:06  loss: 2.6461 (2.1773)  acc1: 45.7031 (52.7902)  acc5: 70.5078 (78.0477)  time: 0.9042  data: 0.6566  max mem: 19731
Test:  [97/98]  eta: 0:00:00  loss: 2.2790 (2.1477)  acc1: 47.8516 (53.4100)  acc5: 74.6094 (78.4420)  time: 0.8984  data: 0.6565  max mem: 19731
Test: Total time: 0:01:16 (0.7760 s / it)
* Acc@1 53.410 Acc@5 78.442 loss 2.148
Accuracy of the network on the 50000 test images: 53.4%
Max accuracy: 53.41%
Epoch: [34]  [  0/625]  eta: 3:46:18  lr: 0.001941  loss: 4.7680 (4.7680)  time: 21.7254  data: 9.6850  max mem: 19731
Epoch: [34]  [100/625]  eta: 0:11:14  lr: 0.001941  loss: 4.9824 (4.8402)  time: 1.0740  data: 0.0004  max mem: 19731
Epoch: [34]  [200/625]  eta: 0:08:21  lr: 0.001941  loss: 5.0241 (4.8558)  time: 1.0756  data: 0.0004  max mem: 19731
Epoch: [34]  [300/625]  eta: 0:06:11  lr: 0.001941  loss: 4.6879 (4.8099)  time: 1.0617  data: 0.0004  max mem: 19731
Epoch: [34]  [400/625]  eta: 0:04:12  lr: 0.001941  loss: 4.5667 (4.7949)  time: 1.0699  data: 0.0004  max mem: 19731
Epoch: [34]  [500/625]  eta: 0:02:19  lr: 0.001941  loss: 4.4937 (4.7857)  time: 1.0660  data: 0.0004  max mem: 19731
Epoch: [34]  [600/625]  eta: 0:00:27  lr: 0.001941  loss: 4.6047 (4.7868)  time: 1.0887  data: 0.0004  max mem: 19731
Epoch: [34]  [624/625]  eta: 0:00:01  lr: 0.001941  loss: 4.8888 (4.7836)  time: 1.0092  data: 0.0010  max mem: 19731
Epoch: [34] Total time: 0:11:31 (1.1058 s / it)
Averaged stats: lr: 0.001941  loss: 4.8888 (4.7779)
Test:  [ 0/98]  eta: 0:19:22  loss: 1.5326 (1.5326)  acc1: 66.7969 (66.7969)  acc5: 89.0625 (89.0625)  time: 11.8601  data: 11.5745  max mem: 19731
Test:  [10/98]  eta: 0:02:45  loss: 1.5778 (1.6930)  acc1: 64.4531 (62.9261)  acc5: 87.6953 (84.8366)  time: 1.8816  data: 1.6308  max mem: 19731
Test:  [20/98]  eta: 0:01:51  loss: 1.7615 (1.7423)  acc1: 55.8594 (60.4074)  acc5: 84.3750 (84.4959)  time: 0.9036  data: 0.6568  max mem: 19731
Test:  [30/98]  eta: 0:01:27  loss: 1.6570 (1.7007)  acc1: 59.3750 (60.6351)  acc5: 86.3281 (85.6225)  time: 0.9672  data: 0.7190  max mem: 19731
Test:  [40/98]  eta: 0:01:09  loss: 1.6117 (1.7040)  acc1: 61.5234 (61.0518)  acc5: 87.6953 (85.5659)  time: 0.9701  data: 0.7168  max mem: 19731
Test:  [50/98]  eta: 0:00:54  loss: 2.2427 (1.8711)  acc1: 52.3438 (57.8316)  acc5: 75.3906 (82.8470)  time: 0.9018  data: 0.6468  max mem: 19731
Test:  [60/98]  eta: 0:00:41  loss: 2.4386 (1.9445)  acc1: 45.1172 (56.7655)  acc5: 73.2422 (81.4805)  time: 0.8818  data: 0.6311  max mem: 19731
Test:  [70/98]  eta: 0:00:30  loss: 2.4149 (2.0120)  acc1: 48.4375 (55.4550)  acc5: 73.6328 (80.3697)  time: 0.9221  data: 0.6752  max mem: 19731
Test:  [80/98]  eta: 0:00:18  loss: 2.4961 (2.0859)  acc1: 44.9219 (54.1787)  acc5: 72.0703 (79.0533)  time: 0.9022  data: 0.6514  max mem: 19731
Test:  [90/98]  eta: 0:00:08  loss: 2.5877 (2.1393)  acc1: 43.9453 (52.9941)  acc5: 69.7266 (78.1915)  time: 0.8103  data: 0.5490  max mem: 19731
Test:  [97/98]  eta: 0:00:00  loss: 2.2955 (2.1142)  acc1: 48.8281 (53.5220)  acc5: 74.4141 (78.5700)  time: 0.8066  data: 0.5489  max mem: 19731
Test: Total time: 0:01:34 (0.9668 s / it)
* Acc@1 53.522 Acc@5 78.570 loss 2.114
Accuracy of the network on the 50000 test images: 53.5%
Max accuracy: 53.52%
Epoch: [35]  [  0/625]  eta: 2:00:09  lr: 0.001938  loss: 5.5196 (5.5196)  time: 11.5360  data: 9.2732  max mem: 19731
Epoch: [35]  [100/625]  eta: 0:10:18  lr: 0.001938  loss: 4.8989 (4.6219)  time: 1.0739  data: 0.0005  max mem: 19731
Epoch: [35]  [200/625]  eta: 0:08:02  lr: 0.001938  loss: 4.7794 (4.6964)  time: 1.0694  data: 0.0004  max mem: 19731
Epoch: [35]  [300/625]  eta: 0:06:03  lr: 0.001938  loss: 4.7899 (4.7375)  time: 1.0733  data: 0.0004  max mem: 19731
Epoch: [35]  [400/625]  eta: 0:04:08  lr: 0.001938  loss: 4.8782 (4.7286)  time: 1.0743  data: 0.0004  max mem: 19731
Epoch: [35]  [500/625]  eta: 0:02:17  lr: 0.001938  loss: 4.8342 (4.7296)  time: 1.0668  data: 0.0004  max mem: 19731
Epoch: [35]  [600/625]  eta: 0:00:27  lr: 0.001938  loss: 4.3698 (4.7329)  time: 1.0835  data: 0.0004  max mem: 19731
Epoch: [35]  [624/625]  eta: 0:00:01  lr: 0.001938  loss: 4.7100 (4.7351)  time: 1.0075  data: 0.0011  max mem: 19731
Epoch: [35] Total time: 0:11:23 (1.0939 s / it)
Averaged stats: lr: 0.001938  loss: 4.7100 (4.7575)
Test:  [ 0/98]  eta: 0:15:42  loss: 1.5478 (1.5478)  acc1: 68.7500 (68.7500)  acc5: 88.0859 (88.0859)  time: 9.6172  data: 9.3542  max mem: 19731
Test:  [10/98]  eta: 0:02:20  loss: 1.6195 (1.7576)  acc1: 66.0156 (63.8139)  acc5: 88.0859 (84.9609)  time: 1.5983  data: 1.3404  max mem: 19731
Test:  [20/98]  eta: 0:01:36  loss: 1.8143 (1.8013)  acc1: 58.9844 (61.1421)  acc5: 84.5703 (85.1004)  time: 0.8158  data: 0.5640  max mem: 19731
Test:  [30/98]  eta: 0:01:17  loss: 1.7929 (1.7760)  acc1: 58.5938 (60.7737)  acc5: 85.5469 (85.9249)  time: 0.8811  data: 0.6343  max mem: 19731
Test:  [40/98]  eta: 0:01:00  loss: 1.7069 (1.7805)  acc1: 61.5234 (61.0804)  acc5: 86.1328 (85.7517)  time: 0.8554  data: 0.6089  max mem: 19731
Test:  [50/98]  eta: 0:00:49  loss: 2.3951 (1.9486)  acc1: 50.0000 (57.6555)  acc5: 74.2188 (82.9236)  time: 0.8754  data: 0.6237  max mem: 19731
Test:  [60/98]  eta: 0:00:38  loss: 2.5410 (2.0205)  acc1: 44.5312 (56.4453)  acc5: 72.6562 (81.5798)  time: 0.9621  data: 0.7078  max mem: 19731
Test:  [70/98]  eta: 0:00:28  loss: 2.4595 (2.0855)  acc1: 46.2891 (55.0369)  acc5: 73.2422 (80.4908)  time: 0.9315  data: 0.6701  max mem: 19731
Test:  [80/98]  eta: 0:00:17  loss: 2.5426 (2.1519)  acc1: 45.5078 (53.9472)  acc5: 71.0938 (79.2173)  time: 0.9260  data: 0.6665  max mem: 19731
Test:  [90/98]  eta: 0:00:07  loss: 2.6325 (2.2011)  acc1: 45.5078 (52.9726)  acc5: 69.7266 (78.3504)  time: 0.9245  data: 0.6736  max mem: 19731
Test:  [97/98]  eta: 0:00:00  loss: 2.3356 (2.1727)  acc1: 49.8047 (53.5080)  acc5: 75.0000 (78.7940)  time: 0.8465  data: 0.5978  max mem: 19731
Test: Total time: 0:01:37 (0.9923 s / it)
* Acc@1 53.508 Acc@5 78.794 loss 2.173
Accuracy of the network on the 50000 test images: 53.5%
Max accuracy: 53.52%
Epoch: [36]  [  0/625]  eta: 2:13:30  lr: 0.001934  loss: 5.5396 (5.5396)  time: 12.8172  data: 10.2899  max mem: 19731
Epoch: [36]  [100/625]  eta: 0:10:31  lr: 0.001934  loss: 4.8671 (4.8513)  time: 1.0761  data: 0.0004  max mem: 19731
Epoch: [36]  [200/625]  eta: 0:08:05  lr: 0.001934  loss: 5.1033 (4.8462)  time: 1.0730  data: 0.0004  max mem: 19731
